<div class="~urge">
    <form method="GET" id="datePicker" class="~urge">
        <input type="hidden" name="startDate" value="{{start_date.isoformat}}" id="startDate">
        <input type="hidden" name="endDate" value="{{end_date.isoformat}}" id="endDate">
    </form>
    <input type="input" id="rangePicker" placeholder="Date range" class="button ~neutral @low cursor-pointer" style="max-width: 200px;" readonly>
</div>
<style>
    :root {
        --litepicker-button-prev-month-color-hover: #7c3aed;
        --litepicker-button-next-month-color-hover: #7c3aed;
        --litepicker-day-color-hover: #7c3aed;
        --litepicker-is-today-color: #7c3aed;
        --litepicker-is-in-range-color: #ddd6fe;
        --litepicker-is-start-color-bg: #7c3aed;
        --litepicker-is-end-color-bg: #7c3aed;
        --litepicker-button-apply-color-bg: #7c3aed;
    }

    .litepicker .container__predefined-ranges, .litepicker .container__months {
        box-shadow: var(--fallback-box-shadow-normal) !important;
    }
</style>
<script>
    var picker = new Litepicker({
        element: document.getElementById('rangePicker'),
        plugins: ['ranges'],
        singleMode: false,
        format: "MMM DD 'YY",
        maxDate: new Date(),
        startDate: Date.parse(document.getElementById("startDate").getAttribute("value")),
        endDate: Date.parse(document.getElementById("endDate").getAttribute("value")),
        ranges: {
            customRanges: {
                {% for date_range in date_ranges %}
                    '{{ date_range.name }}': [
                        new Date('{{ date_range.start.isoformat }}'),
                        new Date('{{ date_range.end.isoformat }}')
                    ],
                {% endfor %}
            }
        }
    });
    picker.on('selected', (startDate, endDate) => {
        document.getElementById("startDate").setAttribute("value", startDate.getFullYear() +
            "-" + (startDate.getMonth() + 1) + "-" + startDate.getDate());
        document.getElementById("endDate").setAttribute("value", endDate.getFullYear() + "-" +
            (endDate.getMonth() + 1) + "-" + endDate.getDate());
        document.getElementById("datePicker").submit();
    });
</script>
